import{d as E,c as a,a as p,g as u,t as f,i as w,r as x,q as $}from"./web.CGV0YjKn.js";import{t as n}from"./toast.wqlfmKb2.js";import"./store.wnBxOkpW.js";var L=f('<button class="btn btn-wide bg-base-100 font-serif">'),M=f('<button class="btn btn-wide font-serif">已加载全部文章');const C=e=>{const[g,o]=a(!1),[r,m]=a(e.currentPage),[b,s]=a(!e.next),c=()=>r()*e.size<e.total;async function h(){if(!e.next||!c()){s(!0);return}o(!0);try{const t=await fetch(`/${r()+1}`);if(!t.ok){n.error("加载失败");return}const y=await t.text(),i=new DOMParser().parseFromString(y,"text/html").querySelector("[data-article-list]");if(!i){n.error("解析内容失败");return}const l=document.querySelector("[data-article-list]");l&&Array.from(i.childNodes).forEach(d=>{d.nodeType===Node.ELEMENT_NODE&&l.appendChild(d)}),m(r()+1),c()||s(!0)}catch(t){console.error("加载更多文章失败",t),n.error("加载失败")}finally{o(!1)}}return p($,{get when(){return!b()},get fallback(){return u(M)},get children(){var t=u(L);return t.$$click=h,w(t,()=>g()?"加载中...":"加载更多文章"),x(),t}})};E(["click"]);export{C as default};
